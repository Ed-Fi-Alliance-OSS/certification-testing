meta {
  name: 01 - Check Calendar is valid
  type: http
  seq: 1
}

get {
  url: {{resourceBaseUrl}}/ed-fi/Calendars?schoolId={{tempSchoolId}}&calendarCode=107SS111111&schoolYear=2025
  body: none
  auth: inherit
}

params:query {
  schoolId: {{tempSchoolId}}
  calendarCode: 107SS111111
  schoolYear: 2025
  ~calendarTypeDescriptor: 
  ~id: {{tempCalendarId}}
}

assert {
  res.status: eq 200
  res.body: isArray
  res.body[0].id: isDefined
  res.body[0].calendarCode: isString
  res.body[0].schoolReference: isDefined
  res.body[0].schoolReference.schoolId: isNumber
  res.body[0].schoolYearTypeReference: isDefined
  res.body[0].schoolYearTypeReference.schoolYear: isNumber
  res.body[0].calendarTypeDescriptor: isString
  res.body[0].gradeLevels: isArray
}

script:post-response {
  const { cacheCalendarResponse } = require('./v4/EducationOrganization/Calendars/calendars-utils');
  if (res.status === 200) {
    cacheCalendarResponse(bru, res.getBody());
  }
}

settings {
  encodeUrl: true
}

docs {
  # v4 Education Organization Calendar > Calendar Scenarios
  
  This entity represents aÂ set of dates associated with an organization.
  
  ## Prerequisites
  
  * None
  
  ## Scenarios
  
  1. Create an IEP calendar for the elementary school.
  2. Create an IEP calendar for the high school for ninth grade.
  3. Update the calendar for the elementary school to be student specific.
  4. Update the calendar for the high school to include tenth grade also.
  
  | Resource                | Property Name          | Is Collection | Data Type              | Required    | Scenario 1: POST      | Scenario 2: POST      | Scenario 3: PUT       | Scenario 4: PUT                 |
  | ----------------------- | ---------------------- | ------------- | ---------------------- | ----------- | --------------------- | --------------------- | --------------------- | ------------------------------- |
  | Calendars               | calendarCode           | FALSE         | string                 | REQUIRED    | 107SS111111           | IEP001                | 107SS111111           | IEP001                          |
  | Calendars               | schoolReference        | FALSE         | schoolReference        | REQUIRED    |                       |                       |                       |                                 |
  | schoolReference         | schoolId               | FALSE         | integer                | REQUIRED    | 255901107             | 255901001             | 255901107             | 255901001                       |
  | Calendars               | schooYearTypeReference | FALSE         | schooYearTypeReference | REQUIRED    |                       |                       |                       |                                 |
  | schoolYearTypeReference | schoolYear             | FALSE         | int                    | REQUIRED    | [Current School Year] | [Current School Year] | [Current School Year] | [Current School Year]           |
  | Calendars               | calendarTypeDescriptor | FALSE         | calendarTypeDescriptor | REQUIRED    | IEP                   | IEP                   | **Student Specific**  | IEP                             |
  | Calendars               | gradelevels            | TRUE          | gradeLevels[]          | CONDITIONAL |                       |                       |                       |                                 |
  | calendarGradeLevels     | gradeLevelDescriptor   | FALSE         | string                 | CONDITIONAL |                       | Ninth grade           |                       | Ninth grade,  **Tenth grade** |
}
